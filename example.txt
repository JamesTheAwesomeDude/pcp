from pathlib import Path
from _util import to_ber, TagMode
from _main import OID_DATA
import asn1

Path('private.pfx').write_bytes(to_ber([
    (3,),
    ([  # PFX.authSafe
        (OID_DATA, asn1.Numbers.ObjectIdentifier),
        ((
            ([
                ([  # AuthenticatedSafe
                    ([  # CI_i
                        (OID_DATA, asn1.Numbers.ObjectIdentifier),
                        ((
                            ([
                                ([  # SafeContents
                                        ([  # SafeBag
                                            ('1.2.840.113549.1.12.10.1.1', asn1.Numbers.ObjectIdentifier),
                                            ((
                                                [  # KeyBag aka PrivateKeyInfo
                                                    (0,),
                                                    ([
                                                        ('1.2.840.113549.1.1.1', asn1.Numbers.ObjectIdentifier),
                                                        (None,),
                                                    ],),
                                                    (([
                                                        (([
                                                            (0,),
                                                            (2140324650240744961264423072839333563008614715144755017797754920881418023447140136643345519095804679610992851872470914587687396261921557363047454770520805119056493106687691590019759405693457452230589325976697471681738069364894699871578494975937497937,),
                                                            (3,),
                                                            (1426883100160496640842948715226222375339076476763170011865169947254278682298093424428897012730536453073995234581647276391791532503069656875540413169546686124368786893941735919345256336208558935904343657133995743653597616516186314818004361532804387907,),
                                                            (33372027594978156556226010605355114227940760344767554666784520987023841729210037080257448673296881877565718986258036932062711,),
                                                            (64135289477071580278790190170577389084825014742943447208116859632024532344630238623598752668347708737661925585694639798853367,),
                                                            (22248018396652104370817340403570076151960506896511703111189680658015894486140024720171632448864587918377145990838691288041807,),
                                                            (42756859651381053519193460113718259389883343161962298138744573088016354896420159082399168445565139158441283723796426532568911,),
                                                            (15153971327739716274777480268318738326876582674291950135952813989995793122413053276883632043938325387519958686606252004394930,),
                                                        ]), asn1.Numbers.Sequence),
                                                    ]), asn1.Numbers.OctetString),
                                                    (([
                                                        (2140324650240744961264423072839333563008614715144755017797754920881418023447140136643345519095804679610992851872470914587687396261921557363047454770520805119056493106687691590019759405693457452230589325976697471681738069364894699871578494975937497937,),
                                                        (3,)
                                                    ]), 1, TagMode.Implicit),
                                                ],
                                            ), 0, TagMode.Explicit),
                                            ([  # bagAttributes
                                                ([
                                                    ('1.2.840.113549.1.9.20', asn1.Numbers.ObjectIdentifier),
                                                    ([
                                                        ('TEST123', asn1.Numbers.IA5String),
                                                    ], asn1.Numbers.Set),
                                                ],),
                                            ], asn1.Numbers.Set),
                                        ],),
                                    ],),
                            ], asn1.Numbers.OctetString)
                        ), 0, TagMode.Explicit),
                    ],),
                ],),
            ], asn1.Numbers.OctetString)
        ), 0, TagMode.Explicit)
    ],),
]))
